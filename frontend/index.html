<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>ChronaX – Timestamp Registry</title>
  <script src="https://cdn.jsdelivr.net/npm/ethers@6.7.1/dist/ethers.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #0b0f19;
      color: #fff;
      padding: 20px;
    }
    input { width: 100%; padding: 10px; margin-top: 10px; }
    button { 
      margin-top: 10px; padding: 10px; width: 100%; 
      background: #407bff; border: none; color: white; cursor: pointer; 
    }
    button:hover { background: #1e5aff; }
    .box { margin-top: 20px; padding: 15px; background: #111; border-radius: 10px; }
  </style>
</head>
<script src="app.js"></script>
<body>

<h2>ChronaX — Timestamp Registry</h2>

<div class="box">
  <h3>Register Hash</h3>
  <input id="inputHash" placeholder="0x1234..." />
  <button onclick="registerHash()">Register</button>
</div>

<div class="box">
  <h3>Check Hash</h3>
  <input id="checkHash" placeholder="0x1234..." />
  <button onclick="checkHash()">Check</button>

  <p id="result"></p>
</div>

<script>
  // ==== CONFIGURATION ====
  const CONTRACT_ADDRESS = "PASTE_ADDRESS_KONTRAK_KAMU";
  const ABI = [
    "function register(bytes32 dataHash) external",
    "function getRecord(bytes32 dataHash) external view returns (address owner, uint256 timestamp, string memory description)",
    "function isRegistered(bytes32 dataHash) external view returns (bool)"
  ];

  let provider, signer, contract;

  async function connect() {
    await window.ethereum.request({ method: "eth_requestAccounts" });
    provider = new ethers.BrowserProvider(window.ethereum);
    signer = await provider.getSigner();
    contract = new ethers.Contract(CONTRACT_ADDRESS, ABI, signer);
  }
  connect();

  async function registerHash() {
    const hash = document.getElementById("inputHash").value;

    try {
      const tx = await contract.register(hash, "");
      await tx.wait();
      alert("Hash registered successfully!");
    } catch (err) {
      alert("Error: " + err);
    }
  }

  async function checkHash() {
    const hash = document.getElementById("checkHash").value;

    try {
      const record = await contract.getRecord(hash);

      document.getElementById("result").innerHTML = `
        <br>Owner: ${record.owner}
        <br>Timestamp: ${new Date(record.timestamp * 1000).toLocaleString()}
        <br>Description: ${record.description}
      `;
    } catch (err) {
      document.getElementById("result").innerHTML = "Hash not found!";
    }
  }
</script>

</body>
</html>
